<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./../asssets/css/profile.css" />
    <title>Document</title>
  </head>
  <body>
       <div class="card">
          <div class="img-1">
            <img src="" width="70">
              <h1>Saving<span>lives.</span></h1>
              </div>
          <div class="card-body">
            <form id="profile_form">
              <div class="form-group">
                <label >User Name</label>
                <input required="" id="First_name" type="text">
              </div>
              <div class="form-group">
                <label >Email</label>
                <input required=""  id="Email" type="email">
              </div>
              <div class="form-group">
                <label >Phone Number</label>
                <input required="" id="Phone_Number" type="number"  pattern="[0-9]{10}">
              </div>
              <div class="form-group">
                <label >Password</label>
                <input required="" id="Password" type="password">
              </div>
              <br>
             <!-- <input type="submit" class="btn" value="submit"></form> -->
             <button id="submit" type="submit">Edit</button>
        <button id="delete">Delete</button>
      <button id="logout" click="logout" type="button">Log out</button>
             <br>
             <br>
             <div class="text">
              <p>Already have an account? <a href="./login.html">Login here</a></p>
              <p>Back to the <a href="./home1.html">Home page</a></p>
            </div>
          </div>
      </div>
      </div>
    </form>
    <footer></footer>
    <script>
      const user = JSON.parse(localStorage.getItem("users"));
      const users = JSON.parse(localStorage.getItem("oneUser"));
      let select_user = user.find(function (event) {
        let customerEmail = event["userEmail"];
        if (users == customerEmail){
          return true;
        } else if (users == customerEmail){
          return true;
        }
      });
      console.log(select_user);
      // to get value from registration form
      const email = document.getElementById("Email");
      const phNo = document.getElementById("Phone_Number");
      const userName = document.getElementById("First_name");
      const pws = document.getElementById("Password");
      // Compare the values
      email.value = select_user["userEmail"];
      phNo.value = select_user["userPhoneNumber"];
      userName.value = select_user["userName"];
      pws.value = select_user["userPassword"];
      // to replace the values
      const form = document.getElementById("profile_form");
      form.addEventListener("submit", function(event) {
        event.preventDefault();
        let userName = document.getElementById("First_name").value;
        let userEmail = document.getElementById("Email").value;
        let userPhoneNumber = document.getElementById("Phone_Number").value;
        let userPassword = document.getElementById("Password").value;
        let newData = {
          userName,
          userEmail,
          userPhoneNumber,
          userPassword,
        }
        console.log(newData);
        const combineData = Object.assign(select_user, newData);
        console.log(combineData);
        let index = user.indexOf(select_user);
        user[index] = combineData;
        localStorage.setItem("users" , JSON.stringify(user));
        alert("successfully changed");
        // location.reload();    
      });
        
        // assign the value to
        
        const set_details = JSON.parse(localStorage.getItem("users"));
        let get_details = set_details.find(function(user_obj){
          let check_email = user_obj["userEmail"];
          if(set_details === check_email){
        let user_Email = document.getElementById("First_name");
        let user_ph_no = document.getElementById("Email");
        let user_email = document.getElementById("Phone_Number");
        let user_password = document.getElementById("Password");
        let oneUser = document.getElementById("users");
      }
      });
      // delete option in the page

      let delete_user = document.getElementById("delete");
      delete_user.addEventListener("click", function (event) {
        event.preventDefault();
        let indexDel = set_details.indexOf(select_user);
        let msg = confirm("Are you sure you want to delete this account.");
        if (msg !== true) {
          return;
        } else {
          set_details.splice(indexDel, 1);
          console.log(set_details);
          localStorage.setItem("users", JSON.stringify(users));
          window.location.href = "./signup_page.html";
        }
      });      
    
      let logout_user = document.getElementById("logout");
      logout_user.addEventListener("click", function (event) {
        event.preventDefault();
        let indexDel = users.indexOf(select_user);
        let msg = confirm("Are you sure you want to logout this account");
        if (msg !== true) {
          return;
        } else {
          window.location.href = "./signup_page.html";
        }
      });
    </script>
   
  </body>
</html>